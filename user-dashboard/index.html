<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>داشبورد کاربری</title>

  <link rel="stylesheet" href="../css/colors.css">
  <link rel="stylesheet" href="../css/user-dashboard.css">
  <link rel="stylesheet" href="../css/user-sidebar.css">
  <link rel="stylesheet" href="../fonts/fonts.css">
</head>
<body>

<div class="body_container">
  <!-- سایدبار -->
  <aside id="sidebar" class="sidebar"></aside>

  <!-- محتوای اصلی -->
  <main class="main_content">
    
    <!-- هدر -->
    <header class="dashboard_header" id="dashboard_header">
      <script>
        // بارگذاری محتوای هدر
        fetch('dashboard-header.html')
          .then(response => response.text())
          .then(html => {
            document.getElementById('dashboard_header').innerHTML = html;
          });
      </script>
    </header>

    <!-- پروفایل کاربر -->
    <section class="user_profile_section">
      <div class="user_profile_card">
        <header class="user_profile_header">
          <div class="user_profile_avatar">
            <img src="../img/profile.jpg" alt="profile" id="user_avatar">
          </div>
          <div class="user_profile_identity">
            <h2 id="user_name">-</h2>
            <p class="user_profile_email" id="user_email_primary">-</p>
            <div class="user_profile_meta">
              <span class="user_profile_badge" id="user_rank">-</span>
              <span class="user_profile_badge user_profile_badge--muted" id="user_status">-</span>
            </div>
          </div>
          <button class="edit_user_btn" type="button" data-action="edit-user" aria-label="ویرایش پروفایل" title="ویرایش پروفایل">
            <svg class="edit_user_btn__icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zm2.92 2.5H5v-1.02l9.06-9.06 1.02 1.02-9.16 9.06zm13.71-12.13a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" />
            </svg>
            <span class="visually_hidden">ویرایش پروفایل</span>
          </button>
        </header>

        <div class="user_profile_details">
          <dl class="user_profile_list">
            <div>
              <dt>نام کاربری</dt>
              <dd id="user_username">-</dd>
            </div>
            <div>
              <dt>نام کامل</dt>
              <dd id="user_full_name">-</dd>
            </div>
            <div>
              <dt>ایمیل</dt>
              <dd id="user_email_detail">-</dd>
            </div>
            <div>
              <dt>شماره تماس</dt>
              <dd id="user_phone">-</dd>
            </div>
            <div>
              <dt>تاریخ عضویت</dt>
              <dd id="user_add_date">-</dd>
            </div>
          </dl>
        </div>

        <div class="user_stats_grid">
          <div class="user_stat_card">
            <span class="user_stat_label">امتیاز شما</span>
            <span class="user_stat_value" id="user_score">0</span>
          </div>
          <div class="user_stat_card">
            <span class="user_stat_label">تورنومنت‌ها</span>
            <span class="user_stat_value" id="user_tournaments_played">0</span>
          </div>
          <div class="user_stat_card">
            <span class="user_stat_label">تعداد تیم‌ها</span>
            <span class="user_stat_value" id="user_teams">0</span>
          </div>
        </div>
      </div>
    </section>

    <!-- تیم‌ها -->
    <section class="user_teams_section">
      <div class="user_teams_card">
        <div class="team_title">
          <div class="team_title_text">
            <span>تیم‌های شما</span>
            <span class="team_counter" id="teams_counter">0 تیم</span>
          </div>
          <a href="teams.html" class="creat_team_link">مدیریت تیم‌ها</a>
        </div>
        <div class="teams_container" id="teams_container">
          <!-- تیم‌ها اینجا با JS پر می‌شوند -->
        </div>
        <p class="teams_hint" id="teams_overflow_hint"></p>
      </div>
    </section>

    <!-- تاریخچه تورنومنت -->
    <section class="user_tournaments_history">
      <div class="user_tournaments_history">
        <div class="user_history_title">
          <span>تاریخچه تورنومنت‌ها</span>
          <div class="user_history_filter">
            <button class="filter">فیلتر</button>
            <button class="sort">مرتب‌سازی</button>
          </div>
        </div>
        <div class="user_tournaments_history_table">
          <table>
            <thead>
              <tr>
                <th>امتیاز</th>
                <th>رتبه</th>
                <th>تاریخ</th>
                <th>تیم</th>
                <th>بازی</th>
                <th>تورنومنت</th>
              </tr>
            </thead>
            <tbody id="tournaments_history_body">
              <!-- تاریخچه تورنومنت‌ها اینجا با JS پر می‌شوند -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

  </main>
</div>

<script src="../js/alert.js"></script>
<script src="../js/sidebar.js"></script>
<script type="module" src="../js/user-dashboard.js"></script>

<!-- ویرایش پروفایل کاربر -->
<div class="modal" id="edit_user_modal" aria-hidden="true">
  <form class="modal__dialog modal_form" id="edit_user_form">
    <header class="modal__header">
      <h2>ویرایش پروفایل کاربر</h2>
      <button type="button" class="modal__close" data-close-modal aria-label="بستن">×</button>
    </header>
    <div class="modal__body">
      <p class="modal_description">اطلاعات زیر را ویرایش کنید و سپس دکمه ذخیره را بزنید.</p>
      <div class="modal_form_grid">
        <label class="modal_form_field modal_form_field--full">
          <span>عکس پروفایل</span>
          <div class="modal_avatar_input">
            <div class="modal_avatar_preview">
              <img src="../img/profile.jpg" alt="پیش‌نمایش تصویر پروفایل" id="edit_user_avatar_preview">
            </div>
            <div class="modal_avatar_actions">
              <input type="file" id="edit_user_avatar" name="profile_picture" accept="image/*">
              <small>حداکثر اندازه پیشنهادی ۵ مگابایت و فرمت‌های تصویر متداول</small>
            </div>
          </div>
        </label>
        <label class="modal_form_field">
          <span>نام کاربری</span>
          <input type="text" id="edit_user_username" name="username" required data-autofocus>
        </label>
        <label class="modal_form_field">
          <span>نام</span>
          <input type="text" id="edit_user_first_name" name="first_name">
        </label>
        <label class="modal_form_field">
          <span>نام خانوادگی</span>
          <input type="text" id="edit_user_last_name" name="last_name">
        </label>
        <label class="modal_form_field">
          <span>ایمیل</span>
          <input type="email" id="edit_user_email" name="email" required>
        </label>
        <label class="modal_form_field">
          <span>شماره تماس</span>
          <input type="tel" id="edit_user_phone" name="phone_number" inputmode="tel">
        </label>
        <label class="modal_form_field">
          <span>درباره من</span>
          <textarea id="edit_user_bio" name="bio" rows="3"></textarea>
        </label>
      </div>
      <p class="modal_form_message" id="edit_user_message" role="status"></p>
    </div>
    <footer class="modal__footer">
      <button type="button" class="modal_btn modal_btn--secondary" data-close-modal>انصراف</button>
      <button type="submit" class="modal_btn modal_btn--primary">ذخیره تغییرات</button>
    </footer>
  </form>
</div>

</body>
</html>
