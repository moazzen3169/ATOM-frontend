<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chat page</title>
    <link rel="stylesheet" href="../css/colors.css">
    <link rel="stylesheet" href="../fonts/fonts.css">
    <link rel="stylesheet" href="../css/chat.css">
</head>
<body>
    <div class="chat_container">
        <!-- ساید بار برای نمایش لیست کاربران -->
        <div class="chat_contacts_list">
            <div class="chat_header">
                <div class="user_info">
                    <div class="user_profile">
                        <img src="../img/profile.jpg" alt="profile">
                    </div>
                    <span>شما</span>
                </div>
                <div class="chat_menu">
                    <button class="menu_btn" id="new-conversation-btn" aria-label="ایجاد گفتگو جدید">
                        <img src="../img/icons/plus.svg" alt="New Conversation">
                    </button>
                </div>
            </div>
            <div class="contact_list">
                <!-- Dynamic contacts will be rendered here -->
            </div>
        </div>

        <!-- برای نمایش چت کاربر انتخاب شده -->
        <div class="chat_contact_messages">
            <div class="contact_messages_header">
                <div class="logo">
                    <img src="../img/logo.png" alt="logo">
                </div>
                <div class="selected_contact" role="presentation">
                    <button class="back" type="button" aria-label="بازگشت">
                        <img src="../img/icons/back.svg" alt="back">
                    </button>
                    <div class="contact_profile" aria-hidden="true">
                        <img src="../img/icons/user-icon.svg" alt="profile">
                    </div>
                    <div class="contact_content">
                        <span class="contact_username">contact name</span>
                        <span class="contact_meta">در انتظار انتخاب مکالمه</span>
                    </div>
                </div>
            </div>

            <div class="messages_container"></div>

            <div class="data_sending_section">
                <form id="data_sender_form" class="data_sender_form" method="post" novalidate>
                    <div class="attachment_inputs">
                        <label class="files" for="file_input" title="افزودن پیوست">
                            <img src="../img/icons/file-input.svg" alt="افزودن پیوست">
                        </label>
                        <input type="file" name="file" id="file_input" accept="image/*,video/*,.pdf,.zip,.rar,.7z,.txt,.doc,.docx,.ppt,.pptx,.xls,.xlsx" multiple style="display: none;">
                    </div>
                    <div id="attachment_previews" class="attachment_previews" aria-live="polite" aria-label="پیوست های انتخاب شده" hidden></div>
                    <p id="attachment_error" class="attachment_error" role="alert" aria-live="assertive" hidden></p>
                    <p id="chat-form-error" class="chat_form_error" role="alert" aria-live="assertive" hidden></p>
                    <input class="chat_input" type="text" name="chat-input" id="chat-input" placeholder="متن خود را وارد کنید.">
                    <button type="submit" class="sender" aria-label="ارسال پیام" id="chat-submit-btn">
                        <img src="../img/icons/send.svg" alt="send">
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div id="new-conversation-modal" class="chat-modal" role="dialog" aria-modal="true" aria-labelledby="chat-modal-title">
        <div class="chat-modal__content">
            <button type="button" class="chat-modal__close" data-close-modal aria-label="بستن">
                <span aria-hidden="true">&times;</span>
            </button>
            <h2 id="chat-modal-title">شروع گفتگو جدید</h2>
            <p class="chat-modal__description">نام کاربری فرد مورد نظر را وارد کرده و از نتایج نمایش داده شده انتخاب کنید.</p>
            <form id="chat-new-conversation-form" class="chat-modal__form">
                <label for="chat-user-search-input">نام کاربری</label>
                <div class="chat-modal__field">
                    <input type="text" id="chat-user-search-input" name="username" placeholder="مثال: atom_player" autocomplete="off" required>
                    <button type="submit" id="chat-modal-submit">جستجو</button>
                </div>
            </form>
            <p id="chat-modal-error" class="chat-modal__error hidden" role="alert"></p>
            <div id="chat-user-search-results" class="chat-modal__results"></div>
        </div>
    </div>

    <div id="chat-edit-modal" class="chat-modal chat-modal--compact" role="dialog" aria-modal="true" aria-labelledby="chat-edit-modal-title">
        <div class="chat-modal__content">
            <button type="button" class="chat-modal__close" data-close-modal aria-label="بستن">
                <span aria-hidden="true">&times;</span>
            </button>
            <h2 id="chat-edit-modal-title">ویرایش پیام</h2>
            <p class="chat-modal__description">متن پیام خود را به‌روزرسانی کنید و سپس روی ذخیره کلیک کنید.</p>
            <form id="chat-edit-form" class="chat-modal__form">
                <label for="chat-edit-input">متن پیام</label>
                <textarea id="chat-edit-input" class="chat-modal__textarea" rows="4" required placeholder="متن جدید پیام را وارد کنید."></textarea>
                <p id="chat-edit-error" class="chat-modal__error hidden" role="alert"></p>
                <div class="chat-modal__actions">
                    <button type="button" class="chat-modal__secondary" data-close-modal>انصراف</button>
                    <button type="submit" class="chat-modal__primary">ذخیره</button>
                </div>
            </form>
        </div>
    </div>

    <div id="chat-delete-modal" class="chat-modal chat-modal--compact" role="dialog" aria-modal="true" aria-labelledby="chat-delete-modal-title">
        <div class="chat-modal__content">
            <button type="button" class="chat-modal__close" data-close-modal aria-label="بستن">
                <span aria-hidden="true">&times;</span>
            </button>
            <h2 id="chat-delete-modal-title">حذف پیام</h2>
            <p class="chat-modal__description">آیا از حذف این پیام مطمئن هستید؟ پس از حذف، متن پیام برای همه کاربران قابل مشاهده نخواهد بود.</p>
            <div class="chat-modal__actions">
                <button type="button" class="chat-modal__secondary" data-close-modal>انصراف</button>
                <button type="button" id="chat-delete-confirm" class="chat-modal__primary chat-modal__primary--danger">حذف پیام</button>
            </div>
        </div>
    </div>

    <script src="../js/chat/api.js" type="module"></script>
    <script src="../js/chat/chat.js" type="module"></script>
</body>
</html>
