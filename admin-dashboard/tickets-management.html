<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پنل ادمین - مدیریت تیکت‌ها</title>

    <meta name="api-base-url" content="/api">
    <meta name="tickets-endpoint" content="/api/support/tickets/">

    <link rel="stylesheet" href="../css/colors.css">
    <link rel="stylesheet" href="../css/admin-dashboard.css">
    <link rel="stylesheet" href="../css/admin-sidebar.css">
    <link rel="stylesheet" href="../css/admin-tickets.css">
    <link rel="stylesheet" href="../fonts/fonts.css">
</head>
<body>
<div class="body_container">
    <aside id="sidebar" class="sidebar"></aside>

    <main class="main_content">
        <header class="dashboard_header" id="dashboard_header">
            <script>
                fetch('dashboard-header.html')
                    .then(response => response.text())
                    .then(html => {
                        document.getElementById('dashboard_header').innerHTML = html;
                    });
            </script>
        </header>

        <section class="page-heading" aria-label="راهنمای مدیریت تیکت‌ها">
            <div class="page-heading__info">
                <h1>مدیریت تیکت‌های پشتیبانی</h1>
                <p>تمام درخواست‌های کاربران در این بخش قابل رصد، پاسخ‌دهی و پیگیری هستند. با استفاده از فیلترها و میانبرهای سریع می‌توانید در کمترین زمان به درخواست‌های مهم رسیدگی کنید.</p>
            </div>
            <div class="page-heading__actions">
                <button type="button" class="admin-button admin-button--ghost" data-action="reset-filters">
                    <span aria-hidden="true">🧹</span>
                    <span>پاکسازی فیلترها</span>
                </button>
                <button type="button" class="admin-button admin-button--primary" data-action="refresh">
                    <span aria-hidden="true">🔄</span>
                    <span>به‌روزرسانی داده‌ها</span>
                </button>
            </div>
        </section>

        <section class="tickets-analytics" aria-label="آمار کلی تیکت‌ها">
            <article class="analytics-card">
                <div class="analytics-card__meta">
                    <span class="analytics-card__title">کل تیکت‌ها</span>
                    <span class="analytics-card__icon" aria-hidden="true">🎫</span>
                </div>
                <p class="analytics-card__value" data-stat="total">0</p>
                <p class="analytics-card__caption">رصد روند کلی درخواست‌ها</p>
            </article>
            <article class="analytics-card">
                <div class="analytics-card__meta">
                    <span class="analytics-card__title">در انتظار پاسخ</span>
                    <span class="analytics-card__icon" aria-hidden="true">⏱️</span>
                </div>
                <p class="analytics-card__value" data-stat="waiting">0</p>
                <p class="analytics-card__caption">تیکت‌هایی که نیاز به اقدام دارند</p>
            </article>
            <article class="analytics-card">
                <div class="analytics-card__meta">
                    <span class="analytics-card__title">نزدیک به ددلاین</span>
                    <span class="analytics-card__icon" aria-hidden="true">⚠️</span>
                </div>
                <p class="analytics-card__value" data-stat="overdue">0</p>
                <p class="analytics-card__caption">تیکت‌های دارای SLA بحرانی</p>
            </article>
            <article class="analytics-card">
                <div class="analytics-card__meta">
                    <span class="analytics-card__title">رضایت کاربران</span>
                    <span class="analytics-card__icon" aria-hidden="true">⭐</span>
                </div>
                <p class="analytics-card__value" data-stat="csat">0%</p>
                <p class="analytics-card__caption">میانگین امتیاز آخرین بازخوردها</p>
            </article>
        </section>

        <section class="tickets-panel" aria-label="مدیریت و بررسی تیکت‌ها">
            <header class="tickets-panel__header">
                <div class="tickets-panel__title">
                    <h2>فهرست درخواست‌های پشتیبانی</h2>
                    <p>با تمرکز بر وضعیت و اولویت، رسیدگی به تیکت‌ها سریع‌تر و هدفمندتر انجام می‌شود.</p>
                </div>
                <div class="tickets-panel__actions">
                    <button type="button" class="admin-button admin-button--ghost" data-action="refresh">
                        <span aria-hidden="true">↻</span>
                        <span>به‌روزرسانی</span>
                    </button>
                    <button type="button" class="admin-button admin-button--primary" data-action="export">
                        <span aria-hidden="true">📄</span>
                        <span>گزارش‌گیری</span>
                    </button>
                </div>
            </header>

            <div class="tickets-feedback" data-feedback></div>

            <div class="tickets-panel__body">
                <div class="tickets-toolbar" role="group" aria-label="ابزارهای فیلتر و جستجو">
                    <div class="toolbar-group toolbar-group--primary">
                        <label class="toolbar-field search-field">
                            <span class="sr-only">جستجو در تیکت‌ها</span>
                        <input type="search" data-action="search" placeholder="جستجوی شناسه، موضوع یا نام کاربر">
                    </label>
                    <label class="toolbar-field">
                        <span>وضعیت</span>
                        <select data-filter="status">
                            <option value="all">همه وضعیت‌ها</option>
                            <option value="new">جدید</option>
                            <option value="waiting">در انتظار پاسخ</option>
                            <option value="answered">پاسخ داده شده</option>
                            <option value="resolved">حل شده</option>
                            <option value="closed">بسته شده</option>
                        </select>
                    </label>
                    <label class="toolbar-field">
                        <span>اولویت</span>
                        <select data-filter="priority">
                            <option value="all">همه اولویت‌ها</option>
                            <option value="urgent">فوری</option>
                            <option value="high">بالا</option>
                            <option value="medium">متوسط</option>
                            <option value="low">پایین</option>
                        </select>
                    </label>
                    <label class="toolbar-field">
                        <span>کانال</span>
                        <select data-filter="channel">
                            <option value="all">همه کانال‌ها</option>
                            <option value="website">وب‌سایت</option>
                            <option value="tournament">تورنمنت</option>
                            <option value="payment">پرداخت</option>
                            <option value="account">حساب کاربری</option>
                        </select>
                    </label>
                    <label class="toolbar-field">
                        <span>از تاریخ</span>
                        <input type="date" data-filter="from">
                    </label>
                    <label class="toolbar-field">
                        <span>تا تاریخ</span>
                        <input type="date" data-filter="to">
                    </label>
                </div>
                <div class="toolbar-group toolbar-group--secondary">
                    <button type="button" class="toolbar-chip is-active" data-quick="all">همه</button>
                    <button type="button" class="toolbar-chip" data-quick="waiting">منتظر پاسخ</button>
                    <button type="button" class="toolbar-chip" data-quick="high">اولویت بالا</button>
                    <button type="button" class="toolbar-chip" data-quick="overdue">نزدیک به ددلاین</button>
                    <button type="button" class="toolbar-chip" data-quick="unassigned">بدون مسئول</button>
                </div>
                </div>

                <div class="tickets-content">
                    <aside class="tickets-list" data-ticket-list aria-label="فهرست تیکت‌ها"></aside>

                    <section class="ticket-detail" data-ticket-detail aria-live="polite">
                        <div class="ticket-placeholder">
                            <h3>یک تیکت را انتخاب کنید</h3>
                            <p>برای مشاهده جزئیات گفتگو، پاسخ‌دهی و مدیریت وضعیت، از فهرست سمت راست یک تیکت را انتخاب کنید.</p>
                            <ul>
                                <li>نمایش تاریخچه کامل پیام‌ها</li>
                                <li>به‌روزرسانی سریع وضعیت و اولویت</li>
                                <li>ثبت پاسخ عمومی یا یادداشت داخلی</li>
                            </ul>
                        </div>
                    </section>
                </div>
            </div>
        </section>
    </main>
</div>

<script type="module" src="/js/admin-sidebar.js"></script>
<script type="module" src="/js/admin-dashboard.js"></script>
<script type="module" src="/js/admin/admin-tickets.js"></script>
</body>
</html>
